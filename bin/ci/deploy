#!/usr/bin/env bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null && pwd )"

: "${AWS_ACCESS_KEY_ID:?'Set the AWS_ACCESS_KEY_ID environment variable'}"
: "${AWS_SECRET_ACCESS_KEY:?'Set the AWS_SECRET_ACCESS_KEY environment variable'}"
: "${AWS_DEFAULT_REGION:?'Set the AWS_DEFAULT_REGION environment variable'}"

# shellcheck disable=SC1090
source "${DIR}/common.sh"

# shellcheck disable=SC2154
[ -f "${tfplan}" ] || exit -1

terraform apply \
  -auto-approve \
  -compact-warnings \
  -input=false \
  -lock=true "${tfplan}"
